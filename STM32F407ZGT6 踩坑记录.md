`我多踩一个坑，读者就少踩一个坑
最近在研究 SPI 通信，我发现我写的 SPI 通信的代码发送数据与接收到的数据不一致，深入研究了一下，发现是`GPIO_PinAFConfig`这个函数放的位置不对，这个函数得放在`GPIO_Init`的前面，如果是放在`GPIO_Init`后面，就会出现跟我一样的情况，也就是发送的数据与接收到的数据不一致。
![[屏幕截图 2024-10-20 132443.png]]
这就是`GPIO_PinAFConfig`放在`GPIO_Init`后面的接收 0xFF 的代码，但是实际接收到的确实0x7F，这就是我遇到的问题所在，但是在之前的话就正常了。

就像这样

![[屏幕截图 2024-10-20 132749.png]]
今天又遇到了离谱的 Bug，我在用 SPI 来驱动一个显示屏的时候，始终不对劲，因为同样的驱动代码我用 HAL 库写过一遍，我想着移植起来应该很快，但是还是花费了两三天，因为  SPI 的片选信号是软件控制，我用逻辑分析仪抓数据的时候发现片选信号拉低滞后和拉高提前，我研究了这个问题很久，不能得出结论，但是我能通过延时让这个时序合理，我不太能知道`SPI_I2S_SendData`是不是阻塞的，但是我认为应该不是阻塞的，因为我的 CS 拉高放在`SPI_I2S_SendData`之后的，但事实确实在 SPI 发送数据到一半的时候，我的 CS 就已经备拉高了，这使得我走了很多弯路